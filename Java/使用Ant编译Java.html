<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>使用Ant编译Java</title>
    <!--格式化代码的特效脚本-->
    <script type="text/javascript" src="scripts/shCore.js"></script>
    <script type="text/javascript" src="scripts/shBrushBash.js"></script>
    <script type="text/javascript" src="scripts/shBrushCpp.js"></script>
    <script type="text/javascript" src="scripts/shBrushCSharp.js"></script>
    <script type="text/javascript" src="scripts/shBrushCss.js"></script>
    <script type="text/javascript" src="scripts/shBrushDelphi.js"></script>
    <script type="text/javascript" src="scripts/shBrushDiff.js"></script>
    <script type="text/javascript" src="scripts/shBrushGroovy.js"></script>
    <script type="text/javascript" src="scripts/shBrushJava.js"></script>
    <script type="text/javascript" src="scripts/shBrushJScript.js"></script>
    <script type="text/javascript" src="scripts/shBrushPhp.js"></script>
    <script type="text/javascript" src="scripts/shBrushPython.js"></script>
    <script type="text/javascript" src="scripts/shBrushPlain.js"></script>
    <script type="text/javascript" src="scripts/shBrushRuby.js"></script>
    <script type="text/javascript" src="scripts/shBrushScala.js"></script>
    <script type="text/javascript" src="scripts/shBrushSql.js"></script>
    <script type="text/javascript" src="scripts/shBrushVb.js"></script>
    <script type="text/javascript" src="scripts/shBrushXml.js"></script>
    <link type="text/css" rel="stylesheet" href="styles/shCoreZenki.css"/>
    <link type="text/css" rel="stylesheet" href="styles/shThemeZenki.css"/>
    <script type="text/javascript">
        SyntaxHighlighter.all();
    </script>
    <link rel="Stylesheet" type="text/css" href="../css_style/style_zenki.css">

</head>

<body>
<div id="wrapper">
<header>

<div id="logo">
</div>

<nav>
    <ul>
        <!--<li class="first"><a href="diary/diary.html">日记</a></li>-->
     </ul>
</nav>
</header>

<article>

<!-- wrap the vimwiki html -->

<h1 id="toc_1">使用Ant工具</h1>

<div class="toc">
<ul>
<li><a href="#toc_1">使用Ant工具</a>
<ul>
<li><a href="#toc_1.1">编写build.xml文件</a>
<ul>
<li><a href="#toc_1.1.1">基本组成</a>
<ul>
<li><a href="#toc_1.1.1.1">Project</a>
<li><a href="#toc_1.1.1.2">target</a>
<li><a href="#toc_1.1.1.3">property</a>
<li><a href="#toc_1.1.1.4">Path-like Structures</a>
</ul>
<li><a href="#toc_1.1.2">build.xml示例</a>
</ul>
</ul>
</ul>
</div>

<h2 id="toc_1.1">编写build.xml文件</h2>

<h3 id="toc_1.1.1">基本组成</h3>
<pre class="brush:xml">
&lt;project&gt;
    &lt;!!-- 1.全局变量的定义 --&gt;
    &lt;property/&gt;

    &lt;!!-- 2.任务组 --&gt;
    &lt;target&gt;
        &lt;!!-- 3.许多单项任务... 像copy,delete,javac,jar... --&gt;
        &lt;task1/&gt;
        &lt;task2/&gt;
        &lt;task3/&gt;
    &lt;/target&gt;

&lt;/project&gt;
</pre>

<h4 id="toc_1.1.1.1">Project</h4>
<table>
<tr>
<th>
属性
</th>
<th>
描述
</th>
<th>
是否必须
</th>
</tr>
<tr>
<td>
name
</td>
<td>
项目名称
</td>
<td>
No
</td>
</tr>
<tr>
<td>
default
</td>
<td>
缺省的target标识
</td>
<td>
Yes
</td>
</tr>
<tr>
<td>
basedir
</td>
<td>
所有路径的基准路径
</td>
<td>
No
</td>
</tr>
</table>

<h4 id="toc_1.1.1.2">target</h4>
<table>
<tr>
<th>
属性
</th>
<th>
描述
</th>
<th>
是否必须
</th>
</tr>
<tr>
<td>
name
</td>
<td>
任务名称
</td>
<td>
Yes
</td>
</tr>
<tr>
<td>
depends
</td>
<td>
逗号分隔的target列表，表示依赖关系
</td>
<td>
No
</td>
</tr>
<tr>
<td>
if
</td>
<td>
执行target需要设定的属性名
</td>
<td>
No
</td>
</tr>
<tr>
<td>
unless
</td>
<td>
执行target需要清除的属性名
</td>
<td>
No
</td>
</tr>
<tr>
<td>
description
</td>
<td>
关于target的简短描述
</td>
<td>
No
</td>
</tr>
</table>

<h4 id="toc_1.1.1.3">property</h4>
<table>
<tr>
<th>
属性
</th>
<th>
描述
</th>
<th>
是否必须
</th>
</tr>
<tr>
<td>
name
</td>
<td>
属性名称
</td>
<td>
否
</td>
</tr>
<tr>
<td>
value
</td>
<td>
属性值
</td>
<td>
否
</td>
</tr>
</table>

<h4 id="toc_1.1.1.4">Path-like Structures</h4>
<table>
<tr>
<th>
属性
</th>
<th>
描述
</th>
<th>
是否必须
</th>
</tr>
<tr>
<td>
location
</td>
<td>
相对于基目录的文件位置
</td>
<td>
&nbsp;
</td>
</tr>
<tr>
<td>
path
</td>
<td>
逗号分隔的文件列表
</td>
<td>
&nbsp;
</td>
</tr>
</table>

<h3 id="toc_1.1.2">build.xml示例</h3>
<pre class="brush:xml">
&lt;?xml version="1.0"  encoding="GB2312" ?&gt;

&lt;project default="dist" basedir="."&gt;

    &lt;!!--主要的系统环境属性--&gt;
    &lt;property environment="env"/&gt;&lt;!--取window,unix...的环境变量--&gt;
    &lt;property name="java.home" value="${env.JAVA_HOME}"/&gt;
    &lt;property name="ant.home"  value="${env.ANT_HOME}"/&gt;

    &lt;!!--主要的app环境属性--&gt;
    &lt;property name="app.name"      value="hello-ant"/&gt;
    &lt;property name="app.jar"       value="${app.name}.jar"/&gt;
    &lt;property name="app.copyright" value=" Copyright (c) 2002 The Neusoft Software Foundation.  All rights reserved."/&gt;


    &lt;!!--app中src的属性--&gt;
    &lt;property name="src.dir"    value="src" /&gt;
    &lt;property name="src.main"   value="${src.dir}/main"/&gt;
    &lt;property name="src.script" value="${src.dir}/script"/&gt;

    &lt;!!--app用到的lib--&gt;
    &lt;property name="lib.dir" value="lib"/&gt;

    &lt;!!--app的build目录中--&gt;
    &lt;property name="build.dir"      value="build" /&gt;
    &lt;property name="build.classes"  value="${build.dir}/classes"/&gt;
    &lt;property name="build.docs"     value="${build.dir}/docs"/&gt;
    &lt;property name="build.docs.api" value="${build.docs}/api"/&gt;
    &lt;property name="build.lib"      value="${build.dir}/lib"/&gt;

    &lt;!!--app的dist (distribution) 目录中--&gt;
    &lt;property name="dist.dir"      value="dist"/&gt;
    &lt;property name="dist.bin"      value="${dist.dir}/bin"/&gt;
    &lt;property name="dist.docs"     value="${dist.dir}/docs"/&gt;
    &lt;property name="dist.lib"      value="${dist.dir}/lib"/&gt;

    &lt;!!--app的docs目录中--&gt;
    &lt;property name="docs.dir"      value="docs"/&gt;

    &lt;path id="classpath"&gt;
        &lt;!!--本项目只有一个java，用不上classpath，这里只是做个例子--&gt;
        &lt;pathelement location="${build.classes}"/&gt;
        &lt;pathelement path="${java.home}/lib/tools.jar"/&gt;
    &lt;/path&gt;

    &lt;target name="init"&gt;
        &lt;!!--清除以前目录--&gt;
        &lt;delete dir="${build.dir}" failonerror="false" /&gt;
        &lt;delete dir="${dist.dir}"  failonerror="false"/&gt;

        &lt;!!--准备目录--&gt;
        &lt;mkdir dir="${build.dir}"/&gt;
        &lt;mkdir dir="${build.classes}"/&gt;
        &lt;mkdir dir="${build.docs}"/&gt;
        &lt;mkdir dir="${build.docs.api}"/&gt;
        &lt;mkdir dir="${build.lib}"/&gt;

        &lt;mkdir dir="${dist.dir}"/&gt;
        &lt;mkdir dir="${dist.bin}"/&gt;
        &lt;mkdir dir="${dist.lib}"/&gt;
    &lt;/target&gt;

&lt;!!--
    ===================================================================
      Build the code (Compile Tasks,File Tasks)
    ===================================================================
--&gt;
    &lt;target name="build" depends="init"&gt;
        &lt;!!--编译--&gt;
        &lt;javac srcdir="${src.main}" destdir="${build.classes}"&gt;
            &lt;classpath refid="classpath"/&gt;
        &lt;/javac&gt;
    &lt;/target&gt;

&lt;!!--
    ===================================================================
      打包文档(Archive Tasks)
      Create the project jars: xxx1.jar and xxx2.jar
    ===================================================================
--&gt;
   &lt;target name="jars" depends="build"&gt;
        &lt;jar basedir="${build.classes}" jarfile="${build.lib}/${app.jar}"/&gt;
    &lt;/target&gt;

&lt;!!--
     ===================================================================
       Creates the API documentation
     ===================================================================
--&gt;
    &lt;target name="javadocs"
            depends="jars"
            description="--&gt; creates the API documentation"&gt;
        &lt;!!--copy docs 手册... --&gt;
        &lt;copy todir="${build.docs}"&gt;
            &lt;fileset dir="${docs.dir}"/&gt;
        &lt;/copy&gt;

        &lt;javadoc packagenames="hello.ant.*"
                 sourcepath="${src.main}"
                 defaultexcludes="yes"
                 destdir="${build.docs.api}"
                 author="true"
                 version="true"
                 use="true"
                 windowtitle="Docs API"&gt;
             &lt;doctitle&gt;&lt;![CDATA[&lt;h1&gt;hello ant Docs API&lt;/h1&gt;]]&gt;&lt;/doctitle&gt;
             &lt;bottom&gt;&lt;![CDATA[&lt;i&gt;${app.copyright}&lt;/i&gt;]]&gt;&lt;/bottom&gt;
             &lt;tag name="todo" scope="all" description="To do:" /&gt;
         &lt;/javadoc&gt;
    &lt;/target&gt;

&lt;!!--
     ===================================================================
       Create the distribution that can run (Archive Tasks)
       主要是从各目录中把该copy的copy上
     ===================================================================
--&gt;
   &lt;target name="dist" depends="javadocs"&gt;
        &lt;!!--copy bin 执行文件 --&gt;
        &lt;copy todir="${dist.bin}"&gt;
            &lt;fileset dir="${src.script}/"/&gt;
        &lt;/copy&gt;
        &lt;copy todir="${dist.docs}"&gt;
            &lt;fileset dir="${build.docs}/"/&gt;
        &lt;/copy&gt;
        &lt;!!-- copy lib 文件 --&gt;
        &lt;copy todir="${dist.lib}"&gt;
            &lt;fileset dir="${build.lib}/"/&gt;
        &lt;/copy&gt;

    &lt;/target&gt;
&lt;!!--
     ===================================================================
      Cleans everything(File Tasks)
      例如可以删除build中的文件，留给你发挥吧
     ===================================================================
--&gt;
&lt;/project&gt;
</pre>


<footer>
    <a href="index.html" id="back-home">首页</a>
    <a href="index.html" id="back-about">关于</a>
    <a href="http://www.163.com/" id="back-email">Email</a>
</footer>

</article>
</div>

</body>
</html>
