<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>XmlResouceParser解析文件</title>
    <!--格式化代码的特效脚本-->
    <script type="text/javascript" src="scripts/shCore.js"></script>
    <script type="text/javascript" src="scripts/shBrushBash.js"></script>
    <script type="text/javascript" src="scripts/shBrushCpp.js"></script>
    <script type="text/javascript" src="scripts/shBrushCSharp.js"></script>
    <script type="text/javascript" src="scripts/shBrushCss.js"></script>
    <script type="text/javascript" src="scripts/shBrushDelphi.js"></script>
    <script type="text/javascript" src="scripts/shBrushDiff.js"></script>
    <script type="text/javascript" src="scripts/shBrushGroovy.js"></script>
    <script type="text/javascript" src="scripts/shBrushJava.js"></script>
    <script type="text/javascript" src="scripts/shBrushJScript.js"></script>
    <script type="text/javascript" src="scripts/shBrushPhp.js"></script>
    <script type="text/javascript" src="scripts/shBrushPython.js"></script>
    <script type="text/javascript" src="scripts/shBrushPlain.js"></script>
    <script type="text/javascript" src="scripts/shBrushRuby.js"></script>
    <script type="text/javascript" src="scripts/shBrushScala.js"></script>
    <script type="text/javascript" src="scripts/shBrushSql.js"></script>
    <script type="text/javascript" src="scripts/shBrushVb.js"></script>
    <script type="text/javascript" src="scripts/shBrushXml.js"></script>
    <link type="text/css" rel="stylesheet" href="styles/shCoreZenki.css"/>
    <link type="text/css" rel="stylesheet" href="styles/shThemeZenki.css"/>
    <script type="text/javascript">
        SyntaxHighlighter.all();
    </script>
    <link rel="Stylesheet" type="text/css" href="../css_style/style_zenki.css">

</head>

<body>
<div id="wrapper">
<header>

<div id="logo">
</div>

<nav>
    <ul>
        <!--<li class="first"><a href="diary/diary.html">日记</a></li>-->
     </ul>
</nav>
</header>

<article>

<!-- wrap the vimwiki html -->

<h1 id="toc_1">使用XmlResouceParser解析文件</h1>

<div class="toc">
<ul>
<li><a href="#toc_1">使用XmlResouceParser解析文件</a>
<ul>
<li><a href="#toc_1.1">相关类</a>
<li><a href="#toc_1.2">基本处理流程</a>
<li><a href="#toc_1.3">EventType类型</a>
<li><a href="#toc_1.4">示例程序</a>
</ul>
</ul>
</div>

<h2 id="toc_1.1">相关类</h2>
<pre class="brush:java">
import android.content.res.XmlResourceParser;
import android.util.Xml;
</pre>

<h2 id="toc_1.2">基本处理流程</h2>
<ul>
<li>
通过资源ID获取<code>XmlResouceParser</code>类对象，XmlResouceParser类是XmlPullParser类的子类：

<ul>
<li>
getResouce.getXml(int id)

<li>
getRawResouce(int id)

</ul>
<li>
通过<code>getEventType()</code>方法和<code>next()</code>方法遍历整个xml模型树。

</ul>

<h2 id="toc_1.3">EventType类型</h2>
<p>
getEventType()和next()方法返回读取到的xml数据类型，用户根据该数据的类型进行相应的处理
<table>
<tr>
<th>
类型标识
</th>
<th>
值
</th>
<th>
描述
</th>
</tr>
<tr>
<td>
START_DOCUMENT
</td>
<td>
0
</td>
<td>
文档起始标识
</td>
</tr>
<tr>
<td>
END_DOCUMENT
</td>
<td>
1
</td>
<td>
文档结束标识
</td>
</tr>
<tr>
<td>
START_TAG
</td>
<td>
2
</td>
<td>
标签开始标识
</td>
</tr>
<tr>
<td>
END_TAG
</td>
<td>
3
</td>
<td>
标签结束标识
</td>
</tr>
<tr>
<td>
TEXT
</td>
<td>
4
</td>
<td>
文本内容标识
</td>
</tr>
</table>
</p>

<h2 id="toc_1.4">示例程序</h2>
<pre class="brush:java">
public void parseXml() {
    // 获取res/xml下的原生XML文件
    XmlResourceParser parser = getResources().getXml(R.xml.persons);
    try {
        StringBuilder sb = new StringBuilder();
        // 获取eventType
        int eventType = parser.getEventType();
        
        // 获取TAG层级，outside层级为0，root层级为1，依次递增。
        // &lt;!-- outside --&gt;     0
        // &lt;root&gt;               1
        // sometext             1
        //   &lt;foobar&gt;           2
        //   &lt;/foobar&gt;          2
        // &lt;/root&gt;              1
        // &lt;!-- outside --&gt;     0
        final int depth = parser.getDepth();
        
        while (eventType != XmlResourceParser.END_DOCUMENT) {
            switch (eventType) {
                case XmlResourceParser.START_TAG:
                    String tagName = parser.getName();

                    if (("person").equals(tagName)) {
                        // 得到person属性
                        String personid = parser.getAttributeValue(0);
                        sb.append("ID:" + personid);
                    } else if ("name".equals(parser.getName())) {
                        // 得到name属性
                        String name = parser.nextText();
                        sb.append("姓名:" + name);
                    } else if ("age".equals(parser.getName())) {
                        // 得到age属性
                        String age = parser.nextText();
                        sb.append("年龄:" + age);
                    }
                    break;
                case XmlResourceParser.END_TAG:
                    // 结束时加空行
                    if ("person".equals(parser.getName())) {
                        sb.append("\n");
                    }
                    break;
                default:
                    break;
            }
            // 解析下一个事件
            eventType = parser.next();
        }
        // 将解析的结果放在文本编辑框
        edtContent.setText(sb.toString());
    } catch (Exception e) {
    }
}
</pre>


<footer>
    <a href="http://zenki2001cn.github.com/Wiki" id="back-home">首页</a>
    <a href="index.html" id="back-about">关于</a>
    <a href="zenki2001cn@163.com" id="back-email">Email</a>
</footer>

</article>
</div>

</body>
</html>
